#  SPDX-FileCopyrightText: Copyright 2023 Arm Limited and/or its
#  affiliates <open-source-office@arm.com>
#  SPDX-License-Identifier: Apache-2.0
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.

# yaml-language-server: $schema=https://raw.githubusercontent.com/Open-CMSIS-Pack/devtools/schemas/projmgr/2.0.0/tools/projmgr/schemas/clayer.schema.json

layer:
  description: Alif Ensemble E7 ML islands' CPU device layer (High-Performance and High-Efficiency Arm Cortex-M55 CPUs).

  groups:
    # - group: GPIO
    #   add-path:
    #     - ./include
    #   files:
    #     - file: ./src/GpioSignal.cpp
    #     - file: ./include/GpioSignal.hpp
    #     - file: ./src/gpio.c

    # - group: AudioHelpers
    #   for-context: +Alif-E7-M55-HE
    #   files:
    #     - file: ./src/BoardAudioUtils.cpp
    #     - file: ./src/BoardPlotUtils.cpp
    #     - file: ./include/BoardAudioUtils.hpp
    #     - file: ./include/BoardPlotUtils.hpp

    # - group: CameraHelpers
    #   for-context: +Alif-E7-M55-HP
    #   files:
    #     - file: ./src/CameraCapture.cpp

    # - group: Display
    #   for-context: +Alif-E7-M55-HP
    #   files:
    #     - file: ./src/LcdDisplay.cpp

    - group: Retarget
      files:
        - file: ./src/retarget_ensemble.c
        - file: ./src/uart_tracelib.c
        - file: ./include/uart_tracelib.h

    - group: Init
      files:
        - file: ./include/board.h
        - file: ./include/board_defs.h
        - file: ./include/ethosu_npu_init.h
        - file: ./include/platform_drivers.h
        - file: ./src/board_init.c
        - file: ./src/platform_drivers.c
        - file: ./src/ethosu_npu_init.c
        - file: ./src/ethosu_cpu_cache.c
        - file: ./include/ethosu_cpu_cache.h
        - file: ./include/platform_pmu.h
        - file: ./include/timer_ensemble.h
        - file: ./include/ethosu_profiler.h
        - file: ./src/timer_ensemble.c
        - file: ./src/ethosu_profiler.c
        - file: ./include/Profiler.hpp
        - file: ./src/Profiler.cc

  components:
    - component: Arm::Machine Learning:NPU Support:Ethos-U Driver&Generic U55
      # Ensemble B options for NPU
      define:
        - NPU_QCONFIG: 1       # AXI0=M0 for U55/U65
        - NPU_REGIONCFG_0: 1   # AXI0=M0 for U55/U65
        - NPU_REGIONCFG_1: 1   # AXI0=M0 for U55/U65
        - NPU_REGIONCFG_2: 1   # AXI0=M0 for U55/U65
        - NPU_REGIONCFG_3: 1   # AXI0=M0 for U55/U65
        - NPU_REGIONCFG_4: 1   # AXI0=M0 for U55/U65
        - NPU_REGIONCFG_5: 1   # AXI0=M0 for U55/U65
        - NPU_REGIONCFG_6: 1   # AXI0=M0 for U55/U65
        - NPU_REGIONCFG_7: 1   # AXI0=M0 for U55/U65
        - AXI_LIMIT0_MAX_BEATS_BYTES: 1
        - AXI_LIMIT1_MAX_BEATS_BYTES: 1
        - AXI_LIMIT2_MAX_BEATS_BYTES: 1
        - AXI_LIMIT3_MAX_BEATS_BYTES: 1 # 0 = 64 byte burst & 1 = 128 byte burst
        - AXI_LIMIT0_MEM_TYPE: 3
        - AXI_LIMIT1_MEM_TYPE: 3
        - AXI_LIMIT2_MEM_TYPE: 3
        - AXI_LIMIT3_MEM_TYPE: 3 # 3 = Normal Non-cacheable Bufferable

    - component: tensorflow::Machine Learning:TensorFlow:Kernel&Ethos-U

    - component: AlifSemiconductor::Device:Startup
    - component: AlifSemiconductor::Device:SOC Peripherals:USART
    - component: AlifSemiconductor::Device:SOC Peripherals:GPIO
    - component: AlifSemiconductor::Device:SOC Peripherals:PINCONF
    - component: ARM::CMSIS Driver:USART
    - component: ARM::CMSIS Driver:USART:Custom

    - component: AlifSemiconductor::Device:SOC Peripherals:DMA

    # - component: AlifSemiconductor::Device:Startup
    # - component: AlifSemiconductor::Device:SE Services:SE RunTime services&Source
    # - component: AlifSemiconductor::Device:SE Services:MHU Driver
    #   for-context: +Alif-E7-M55-HE

    # - component: AlifSemiconductor::Device:SOC Peripherals:I2S
    #   for-context: +Alif-E7-M55-HE

    # - component: AlifSemiconductor::Device:SOC Peripherals:I3C
    #   for-context: +Alif-E7-M55-HP

    # - component: AlifSemiconductor::Device:SOC Peripherals:CDC200
    #   for-context: +Alif-E7-M55-HP

    # - component: AlifSemiconductor::Device:SOC Peripherals:MIPI CSI2
    #   for-context: +Alif-E7-M55-HP

    # - component: AlifSemiconductor::Device:SOC Peripherals:MIPI DSI
    #   for-context: +Alif-E7-M55-HP

    # - component: AlifSemiconductor::Device:SOC Peripherals:CAMERA Controller
    #   for-context: +Alif-E7-M55-HP

    # - component: AlifSemiconductor::BSP:External peripherals:ILI9806E LCD panel
    #   for-context: +Alif-E7-M55-HP

    # - component: AlifSemiconductor::BSP:External peripherals:CAMERA Sensor ARX3A0
    #   for-context: +Alif-E7-M55-HP
